# BMC AMI DevX Code Pipeline FastMCP Server Configuration
# Copy this file to .env and update the values for your environment

# =============================================================================
# CORE SERVER CONFIGURATION
# =============================================================================

# FastMCP Server Settings
FASTMCP_SERVER_NAME=BMC AMI DevX Code Pipeline MCP Server
FASTMCP_SERVER_VERSION=2.3.0
FASTMCP_LOG_LEVEL=INFO
FASTMCP_MASK_ERROR_DETAILS=false
FASTMCP_INCLUDE_FASTMCP_META=true
FASTMCP_ON_DUPLICATE_TOOLS=error
FASTMCP_RESOURCE_PREFIX_FORMAT=path
FASTMCP_EXPERIMENTAL_ENABLE_NEW_OPENAPI_PARSER=false

# Legacy Server Configuration (for backward compatibility)
HOST=0.0.0.0
PORT=8080
WEBSOCKET_PORT=8081
MCP_TRANSPORT=both
IMPLEMENTATION=python

# =============================================================================
# AUTHENTICATION CONFIGURATION
# =============================================================================

# Enable/Disable Authentication
FASTMCP_AUTH_ENABLED=false

# Authentication Provider (choose one)
# Option 1: JWT Token Verification
# FASTMCP_AUTH_PROVIDER=fastmcp.server.auth.providers.jwt.JWTVerifier
# AUTH_JWKS_URI=https://your-auth-system.com/.well-known/jwks.json
# AUTH_ISSUER=https://your-auth-system.com
# AUTH_AUDIENCE=your-mcp-server

# Option 2: GitHub OAuth (requires manual app registration)
# FASTMCP_AUTH_PROVIDER=fastmcp.server.auth.providers.github.GitHubProvider
# FASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID=Ov23li...
# FASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET=github_pat_...

# Option 3: Google OAuth (requires manual app registration)
# FASTMCP_AUTH_PROVIDER=fastmcp.server.auth.providers.google.GoogleProvider
# FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID=123456.apps.googleusercontent.com
# FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET=GOCSPX-...

# Option 4: WorkOS AuthKit (supports Dynamic Client Registration)
# FASTMCP_AUTH_PROVIDER=fastmcp.server.auth.providers.workos.WorkOSProvider
# FASTMCP_SERVER_AUTH_WORKOS_CLIENT_ID=client_...
# FASTMCP_SERVER_AUTH_WORKOS_CLIENT_SECRET=sk_...
# FASTMCP_SERVER_AUTH_WORKOS_DOMAIN=https://your-project.authkit.app

# Legacy OAuth Configuration (for backward compatibility)
OAUTH_CLIENT_ID=your_client_id_here
OAUTH_CLIENT_SECRET=your_client_secret_here
OAUTH_AUTH_ENDPOINT=https://auth.bmc.com/oauth2/authorize
OAUTH_TOKEN_ENDPOINT=https://auth.bmc.com/oauth2/token
OAUTH_INTROSPECTION_ENDPOINT=https://auth.bmc.com/oauth2/introspect
OAUTH_REDIRECT_URI=http://localhost:8080/oauth/callback

# Legacy JWT Configuration (for backward compatibility)
JWT_SECRET=your_jwt_secret_here_change_in_production
JWT_ALGORITHM=HS256
JWT_EXPIRATION=3600
JWT_REFRESH_EXPIRATION=86400

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

FASTMCP_RATE_LIMIT_ENABLED=true
FASTMCP_RATE_LIMIT_REQUESTS_PER_MINUTE=60
FASTMCP_RATE_LIMIT_BURST_SIZE=10

# Legacy Rate Limiting (for backward compatibility)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================

FASTMCP_CACHE_ENABLED=true
FASTMCP_CACHE_MAX_SIZE=1000
FASTMCP_CACHE_DEFAULT_TTL=300

# =============================================================================
# MONITORING & METRICS CONFIGURATION
# =============================================================================

FASTMCP_MONITORING_ENABLED=true
FASTMCP_METRICS_ENABLED=true
FASTMCP_ERROR_RECOVERY_ENABLED=true
FASTMCP_MAX_RETRY_ATTEMPTS=3

# Legacy Monitoring (for backward compatibility)
METRICS_ENABLED=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30
PERFORMANCE_MONITORING=true

# =============================================================================
# TOOL FILTERING CONFIGURATION
# =============================================================================

# Include only tools with these tags (comma-separated)
FASTMCP_INCLUDE_TAGS=public,api,monitoring,management,workflow,elicitation

# Exclude tools with these tags (comma-separated)
FASTMCP_EXCLUDE_TAGS=internal,deprecated

# =============================================================================
# CUSTOM ROUTES CONFIGURATION
# =============================================================================

FASTMCP_CUSTOM_ROUTES_ENABLED=true
FASTMCP_HEALTH_CHECK_PATH=/health
FASTMCP_STATUS_PATH=/status
FASTMCP_METRICS_PATH=/metrics
FASTMCP_READY_PATH=/ready

# =============================================================================
# RESOURCE TEMPLATES CONFIGURATION
# =============================================================================

FASTMCP_RESOURCE_TEMPLATES_ENABLED=true
FASTMCP_RESOURCE_PREFIX=bmc://

# =============================================================================
# PROMPTS CONFIGURATION
# =============================================================================

FASTMCP_PROMPTS_ENABLED=true

# =============================================================================
# BMC API CONFIGURATION
# =============================================================================

# BMC AMI DevX API Settings
BMC_API_BASE_URL=https://devx.bmc.com/code-pipeline/api/v1
BMC_API_TIMEOUT=30
BMC_API_TOKEN=your_bmc_api_token_here

# Legacy API Configuration (for backward compatibility)
API_BASE_URL=https://devx.bmc.com/code-pipeline/api/v1
API_TIMEOUT=30
API_RETRY_ATTEMPTS=3
API_TOKEN=your_api_token_here
MCP_SERVER_URL=http://127.0.0.1:8080/mcp/

# BMC ISPW Specific Configuration
BMC_AMI_DEVX_ENVIRONMENT=development
BMC_AMI_DEVX_TIMEOUT=30
BMC_AMI_DEVX_RETRY_ATTEMPTS=3
BMC_AMI_DEVX_MAX_CONCURRENT_REQUESTS=10
ISPW_PERSONAL_ACCESS_TOKEN=your_personal_access_token_here

# Optional: Custom Headers for API Requests
# X_BMC_TENANT_ID=your-tenant-id
# X_BMC_USER_ID=your-user-id

# =============================================================================
# OPENAPI CONFIGURATION
# =============================================================================

# OpenAPI Specification Path
FASTMCP_OPENAPI_SPEC_PATH=config/ispw_openapi_spec.json

# Alternative: Load from URL
# FASTMCP_OPENAPI_SPEC_URL=https://api.example.com/openapi.json

# Legacy OpenAPI Configuration (for backward compatibility)
OPENAPI_SPEC_PATH=config/openapi.json

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================

WEBSOCKET_PING_INTERVAL=20
WEBSOCKET_PING_TIMEOUT=10
WEBSOCKET_MAX_CONNECTIONS=100
WEBSOCKET_MAX_MESSAGE_SIZE=1048576

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

CORS_ORIGIN=http://localhost:3000,https://*.bmc.com
CSRF_SECRET=your_csrf_secret_here

# SSL/TLS Configuration (for production)
SSL_ENABLED=false
SSL_CERT_PATH=/app/certs/cert.pem
SSL_KEY_PATH=/app/certs/key.pem
SSL_CA_PATH=/app/certs/ca.pem

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database Configuration (if using external auth)
DATABASE_URL=postgresql://user:password@localhost:5432/fastmcp
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/app/logs/server.log
LOG_MAX_SIZE=10485760
LOG_MAX_FILES=5

# Development Settings
# Uncomment for verbose logging during development
# LOG_LEVEL=DEBUG

# =============================================================================
# FEATURE TOGGLES
# =============================================================================

# Global feature toggle (overrides individual feature settings)
FASTMCP_FEATURE_ENABLED=true

# Development Configuration
NODE_ENV=production
DEBUG=false
DEVELOPMENT_MODE=false
